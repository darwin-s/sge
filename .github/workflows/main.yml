name: CMake Build

on:
    push:
        branches: [ master ]
    pull_request:
        branches: [ master ]

jobs:
    build-ubuntu:
        runs-on: [ubuntu-18.04]
        steps:
            - uses: actions/checkout@v2
              
            - name: Download xorg development files
              run: sudo apt-get install -qq xorg-dev
                  
            - name: Create Build Environment
              run: cmake -E make_directory ${{runner.workspace}}/build

            - name: Configure CMake
              shell: bash
              working-directory: ${{runner.workspace}}/build
              run: CC=gcc-9 CXX=g++-9 cmake $GITHUB_WORKSPACE -DCMAKE_BUILD_TYPE=Release

            - name: Build
              working-directory: ${{runner.workspace}}/build
              shell: bash
              run: CC=gcc-9 CXX=g++-9 cmake --build . --config Release
              
    build-windows:
            runs-on: [windows-latest]
            steps:
                - uses: actions/checkout@v2

                - name: Create Build Environment
                  run: cmake -E make_directory ${{runner.workspace}}/build

                - name: Configure CMake
                  shell: bash
                  working-directory: ${{runner.workspace}}/build
                  run: cmake $GITHUB_WORKSPACE -DCMAKE_BUILD_TYPE=Release

                - name: Build
                  working-directory: ${{runner.workspace}}/build
                  shell: bash
                  run: cmake --build . --config Release
